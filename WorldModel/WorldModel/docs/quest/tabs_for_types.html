<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Using Tabs for Types</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="docs.css">
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Quest Documentation</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li ><a href="index.html">Home</a></li>
            <li ><a href="tutorial/index.html">Tutorial</a></li>
            <li ><a href="http://docs.textadventures.co.uk/quest/scripts/">Scripts</a></li>
            <li ><a href="functions/index.html">Functions</a></li>
            <li ><a href="attributes.html">Attributes</a></li>
            <li><a href="http://textadventures.co.uk/forum">Forum</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>Using Tabs for Types</h1>
      <div class="alert alert-info">
Note: Inherited types and tabs can currently only be edited in the Windows desktop version of Quest.
</div>

<p>So you know all about types, from the <a href="using_inherited_types.html">Using Types</a> page, right? Let us do some more. In this tutorial we will add a new tab to an object so we can easily edit attributes of objects of that type.</p>

<p>Some familiarity with XML (or HTML) will be useful!</p>

<p>This is great if you want to share your library as it makes it much easier for other people to include objects of your type - it is all done through a dedicated tab. If can be useful for you too; if you have a dozen or so of the same type of thing, it may be easier to set up a tab, and then modify the attributes there.</p>

<h2 id="use-a-library">Use a library</h2>

<p>If we are going to get serious, it is better to put your types in another file (and personally, I would put verbs, commands, functions, turnscripts and templates all in there too), so we will do that first.</p>

<p>One reason to use a library is that Quest will not save your tabs, so if you add them to the mnain game they will disappear!</p>

<p>Quest cannot edit library files, so open up in a text editor like Notepad++. Your basic library has a start tag and an end tag. I also put in an XML directive first, so I can use an online XML validator on it (such as <a href="http://validator.w3.org/#validate_by_input">1</a>), in case I have messed up the code so much Quest cannot handle it. The basic framework looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;?xml version="1.0"?&gt;
  &lt;library&gt;
  &lt;/library&gt;
</code></pre></div></div>

<p>Go into the code in Quest, and cut the type from there, and paste it into your library (if you are following this as a tutorial from the previous page, you will see that I have improved the text here a little).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;?xml version="1.0"?&gt;
  &lt;library&gt;
    &lt;type name="spell"&gt;
      &lt;inventoryverbs type="list"&gt;Cast&lt;/inventoryverbs&gt;
      &lt;displayverbs type="list"&gt;Learn&lt;/displayverbs&gt;
      &lt;drop type="boolean"&gt;false&lt;/drop&gt;
      &lt;take type="boolean"&gt;false&lt;/take&gt;
      &lt;usedefaultprefix type="boolean"&gt;false&lt;/usedefaultprefix&gt;
      &lt;learn type="script"&gt;&lt;![CDATA[
        if (not this.parent = player) {
          this.parent = player
          msg ("In a process that seems at once unfathomable, and yet familiar, the spell fades away, and you realise you are now able to cast the &lt;i&gt;" + this.alias + "&lt;/i&gt; spell.")
        }
        else {
          msg ("Er, you already know that one!")
        }
      ]]&gt;&lt;/learn&gt;
    &lt;/type&gt;
  &lt;/library&gt;
</code></pre></div></div>

<p>It is vital that you cut-and-paste everything from the start tag to the end tag, including both tags. Save this file as “library.aslx” in the same directory as your game.</p>

<p>In your game file in Quest, you need an extra line at the top of the code, telling Quest to include your library. The top five lines will be like this, with your library after the two standard libraries (the numbers in the first two lines may be different if you are using a different version).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;!--Saved by Quest 5.7.6404.15496--&gt;
  &lt;asl version="550"&gt;
    &lt;include ref="English.aslx" /&gt;
    &lt;include ref="Core.aslx" /&gt;
    &lt;include ref="Library.aslx" /&gt;
    ...
</code></pre></div></div>

<p>Now go into the game, and check it still works.</p>

<h2 id="more-types">More Types</h2>

<p>We will now set up a new type, attackspell. The attackspell is a particular type of spell, so it needs all the properties of an ordinary spell, but perhaps some new ones too. So it wants to <em>inherit</em> those properties from spell. Here, then, is our new type:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;type name="attackspell"&gt;
    &lt;inherit name="spell"/&gt;
  &lt;/type&gt;
</code></pre></div></div>

<h2 id="a-simple-tab">A Simple Tab</h2>

<p>Let us suppose attack spells will use different elements and have different power ratings. The way to do that is to have attributes on each spell, “powerrating” and “element”. The cool way to do <em>that</em>, is to create new tabs in the editor.</p>

<p>Here is the basic code (paste this in before the &lt;/library&gt; tag).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;tab&gt;
    &lt;parent&gt;_ObjectEditor&lt;/parent&gt;
    &lt;caption&gt;Spell&lt;/caption&gt;
    &lt;mustnotinherit&gt;editor_room; defaultplayer&lt;/mustnotinherit&gt;
    
    &lt;control&gt;
      &lt;controltype&gt;dropdowntypes&lt;/controltype&gt;
      &lt;caption&gt;Spell type&lt;/caption&gt;
      &lt;types&gt;*=Not a spell; spell=Non-attack spell; attackspell=Attack spell&lt;/types&gt;
      &lt;width&gt;150&lt;/width&gt;
    &lt;/control&gt;
  &lt;/tab&gt;
</code></pre></div></div>

<p>So what do we see here? It starts and ends with <code class="highlighter-rouge">&lt;tab&gt;</code> and <code class="highlighter-rouge">&lt;/tab&gt;</code>, so Quest knows this is a tab. The <code class="highlighter-rouge">parent</code> element tells Quest this is an editor for an object (I think they all are). The <code class="highlighter-rouge">caption</code> is the name on the tab, and <code class="highlighter-rouge">mustnotinherit</code> stops this tab appearing for rooms and the player (note these types are separated by semi-colons).</p>

<p>Then there is our control, and you can have several of these. This one gives a dropdown menu, allowing the user to select whether this is not spell, is a non-attack spell, or is an attack spell. The asterisk indicates the null choice, by the way.</p>

<p>Quest will not realise you have changed your library file; to see a difference, you will need to close your game (from the <em>File</em> menu - no need to exit Quest completely), then open it again. Hopefully, if you click on an object you will see a new tab called “Spell”!</p>

<h2 id="more-controls">More Controls</h2>

<p>Now we will put in a powerrating control. Try this (remember, it has to go before the &lt;/tag&gt; line, because that marks the end of the tag):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;number&lt;/controltype&gt;
      &lt;caption&gt;Power of attack (1-10)&lt;/caption&gt;
      &lt;attribute&gt;powerrating&lt;/attribute&gt;
      &lt;width&gt;100&lt;/width&gt;
      &lt;mustinherit&gt;attackspell&lt;/mustinherit&gt;
      &lt;minimum&gt;0&lt;/minimum&gt;
      &lt;maximum&gt;10&lt;/maximum&gt;
    &lt;/control&gt;
</code></pre></div></div>

<p>The <code class="highlighter-rouge">controltype</code> says this is for an integer number, the <code class="highlighter-rouge">caption</code> is again the label the user will see, the <code class="highlighter-rouge">attribute</code> is what is being set, and <code class="highlighter-rouge">width</code>, of course, is the size (not sure if it actually gets used). By setting <code class="highlighter-rouge">mustinherit</code>, this is only visible for attackspells. Also, <code class="highlighter-rouge">minimum</code> and <code class="highlighter-rouge">maximum</code> values are set (but these are only for this tab, the values can change outside the tab by editing the attribute directly or during play, so do not rely on them being in that range).</p>

<p>Now here is a text box, which is pretty straightforward. We can use this for descriptions of what happens.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;textbox&lt;/controltype&gt;
      &lt;caption&gt;Description&lt;/caption&gt;
      &lt;attribute&gt;description&lt;/attribute&gt;
      &lt;mustinherit&gt;spell&lt;/mustinherit&gt;
    &lt;/control&gt;
</code></pre></div></div>

<p>Note that this must inherit from spell, so will be visible for both types of spells (as attack spells inherit from spell).</p>

<p>We also want to be able to select an element (fire for fireball, etc). Now we can create the dropdown list just as we did before (inside the “tab” tags):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;control&gt;
    &lt;controltype&gt;dropdown&lt;/controltype&gt;
    &lt;caption&gt;Element&lt;/caption&gt;
    &lt;attribute&gt;category&lt;/attribute&gt;
    &lt;validvalues type="simplestringlist"&gt;none;Fire;Frost;Storm&lt;/validvalues&gt;
    &lt;mustinherit&gt;attackspell&lt;/mustinherit&gt;
  &lt;/control&gt;
</code></pre></div></div>

<h2 id="other-options">Other Options</h2>

<p>Now you know the basics, you will want to know what other options are available.</p>

<h3 id="conditional-display">Conditional Display</h3>

<p>Often, a tab is only applicable to certain types, or it not applicable to certain types, and you can help keep the GUI tidy by having your tab only displayed when relevant. In this example, the tab will only be shown for objects with the “container” type:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;tab&gt;
    &lt;parent&gt;_ObjectEditor&lt;/parent&gt;
    &lt;caption&gt;My new tab&lt;/caption&gt;
    &lt;mustinherit&gt;container&lt;/mustinherit&gt;
  &lt;/tab&gt;
</code></pre></div></div>

<p>This tab will <em>not</em> be be shown for rooms and the player object.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;tab&gt;
    &lt;parent&gt;_ObjectEditor&lt;/parent&gt;
    &lt;caption&gt;My new tab&lt;/caption&gt;
    &lt;mustnotinherit&gt;editor_room; defaultplayer&lt;/mustnotinherit&gt;
  &lt;/tab&gt;
</code></pre></div></div>

<p>As we saw earlier, the same “mustinherit” and “mustnotinherit” elements can be used inside the controls themselves. This way the user can select the object to be a “container”, and the controls relevant to that type will suddenly appear on the tab.</p>

<p>You can also control what is displayed based on the value of an attribute, using <code class="highlighter-rouge">onlydisplayif</code>. This takes a condition expressed in Quest code. Here are some examples from the core library.</p>

<p>This will display if the “feature_annotations” attribute of the game object is true:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;onlydisplayif&gt;game.feature_annotations&lt;/onlydisplayif&gt;
</code></pre></div></div>

<p>This displays if the “lookonly” attribute of this object is <em>not</em> true:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;onlydisplayif&gt;not this.lookonly&lt;/onlydisplayif&gt;
</code></pre></div></div>

<p>These next three illustrate how you can use any code that you might put inside an <code class="highlighter-rouge">if</code> condition:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;onlydisplayif&gt;game.pov = null&lt;/onlydisplayif&gt;

&lt;onlydisplayif&gt;GetInt(this, "keycount") &gt; 2&lt;/onlydisplayif&gt;

&lt;onlydisplayif&gt;(GetBoolean(this, "locked") or not GetBoolean(this, "visible"))&lt;/onlydisplayif&gt;
</code></pre></div></div>

<h3 id="text-controls">Text controls</h3>

<p>There are several types of controls you can put on your tabs, the simplest are text controls.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;title&lt;/controltype&gt;
        &lt;caption&gt;Colour&lt;/caption&gt;
      &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;label&lt;/controltype&gt;
        &lt;caption&gt;You can use any valid HTML colour name&lt;/caption&gt;
      &lt;/control&gt;
</code></pre></div></div>

<p>The <code class="highlighter-rouge">controltype</code> element tells Quest what type of control you want, the <code class="highlighter-rouge">caption</code> tab puts text on the page. Both <code class="highlighter-rouge">controltype</code> and <code class="highlighter-rouge">caption</code> should be present in all your controls.</p>

<h3 id="basic-controls">Basic Controls</h3>

<p>These five examples show how to add controls for attributes that are Booleans, integers, strings, objects and scripts respectively.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;checkbox&lt;/controltype&gt;
        &lt;caption&gt;Underline hyperlinks&lt;/caption&gt;
        &lt;attribute&gt;underlinehyperlinks&lt;/attribute&gt;
      &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;number&lt;/controltype&gt;
        &lt;caption&gt;Font size&lt;/caption&gt;
        &lt;attribute&gt;menufontsize&lt;/attribute&gt;
      &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;textbox&lt;/controltype&gt;
        &lt;caption&gt;Version&lt;/caption&gt;
        &lt;attribute&gt;version&lt;/attribute&gt;
      &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;objects&lt;/controltype&gt;
        &lt;caption&gt;Key&lt;/caption&gt;
        &lt;attribute&gt;key&lt;/attribute&gt;
     &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;script&lt;/controltype&gt;
        &lt;caption&gt;Start script&lt;/caption&gt;
        &lt;attribute&gt;start&lt;/attribute&gt;
      &lt;/control&gt;
</code></pre></div></div>

<p>There is a new element, <code class="highlighter-rouge">attribute</code>, and this contains the name of the attribute that will be set. It is generally a good idea to set a default value on your type by the way.</p>

<h3 id="not-so-basic">Not So Basic</h3>

<p>This one will give a string, but the type is “richtext”, allowing the user to format the string (this also has the “expand” element, so the text area will expand to fill the tab).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;richtext&lt;/controltype&gt;
        &lt;caption&gt;Description&lt;/caption&gt;
        &lt;attribute&gt;description&lt;/attribute&gt;
        &lt;expand/&gt;
      &lt;/control&gt;
</code></pre></div></div>

<p>For a string list, use the “list” control. You should also add an “editprompt” element, this is the text the user will see as each item is added.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;list&lt;/controltype&gt;
        &lt;caption&gt;Parameters&lt;/caption&gt;
        &lt;attribute&gt;paramnames&lt;/attribute&gt;
        &lt;editprompt&gt;Please enter an parameter name&lt;/editprompt&gt;
      &lt;/control&gt;
</code></pre></div></div>

<p>For a stringdictionary, you need two prompts, like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;stringdictionary&lt;/controltype&gt;
        &lt;caption&gt;Status attributes&lt;/caption&gt;
        &lt;keyprompt&gt;Please enter the attribute name&lt;/keyprompt&gt;
        &lt;valueprompt&gt;Please enter the format string (blank for default)&lt;/valueprompt&gt;
        &lt;attribute&gt;statusattributes&lt;/attribute&gt;
      &lt;/control&gt;
</code></pre></div></div>

<h3 id="dropdown-lists">Dropdown lists</h3>

<p>You can add drop-down lists. There are two types, the first looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;dropdown&lt;/controltype&gt;
        &lt;caption&gt;Category&lt;/caption&gt;
        &lt;attribute&gt;category&lt;/attribute&gt;
        &lt;validvalues type="simplestringlist"&gt;Comedy;Educational;Fantasy;Historical&lt;/validvalues&gt;
        &lt;freetext/&gt;
      &lt;/control&gt;
</code></pre></div></div>

<p>The “validvalues” obviously supplies the list the user can pick from. The “freetext” element tells Quest that the user can also just type in a value.</p>

<p>The second type of drop-down is for selecting the type for an object. Here is an example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;dropdowntypes&lt;/controltype&gt;
      &lt;caption&gt;Container type&lt;/caption&gt;
      &lt;types&gt;*=Not a container; container_open=Container; container_closed=Closed container&lt;/types&gt;
    &lt;/control&gt;
</code></pre></div></div>

<p>So now the control type is “dropdowntypes”, and the different types are listed in the “types” element in the form of a string dictionary. Note that * is used to denote no selection (and this must be present); all other types (“container_open” and “container_closed” in this case) must be defined elsewhere in your game somewhere (and ideally in this same library). Also note there is no attribute element here.</p>

<h3 id="the-multi-type">The multi type</h3>

<p>Sometimes you want to allow the user to decide what type the attribute will be. Use the multi control. As well as the usual elements, you also need a “types” element, a string dictionary that sets up the types:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;caption&gt;Look&lt;/caption&gt;
        &lt;controltype&gt;multi&lt;/controltype&gt;
        &lt;attribute&gt;look&lt;/attribute&gt;
        &lt;types&gt;
          null=No description; string=Text; script=Run script
        &lt;/types&gt;
        &lt;editors&gt;
          string=textbox
        &lt;/editors&gt;     
      &lt;/control&gt;
</code></pre></div></div>

<p>The types here are “null” (no attribute to be set), “string” and “script”. Note that for the string option an editor is specified. I think “textbox” is actually the default, so is not required here; “richtext” is an alternative.</p>

<p>Here is another example, this has boolean as one type, and the associated checkbox is set up as well.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;multi&lt;/controltype&gt;
      &lt;caption&gt;Take&lt;/caption&gt;
      &lt;attribute&gt;take&lt;/attribute&gt;
      &lt;types&gt;
        boolean=Default behaviour; script=Run script
      &lt;/types&gt;
      &lt;checkbox&gt;Object can be taken&lt;/checkbox&gt;
    &lt;/control&gt;
</code></pre></div></div>

<p>You can also use “stringlist”.</p>

<p>Further examples, for completeness:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;multi&lt;/controltype&gt;
      &lt;selfcaption&gt;Action&lt;/selfcaption&gt;
      &lt;attribute&gt;useon&lt;/attribute&gt;
      &lt;types&gt;
        null=None;scriptdictionary=Handle objects individually;string=Print a message
      &lt;/types&gt;
      &lt;keyname&gt;Object&lt;/keyname&gt;
      &lt;keyprompt&gt;Please enter the object name&lt;/keyprompt&gt;
      &lt;source&gt;object&lt;/source&gt;
    &lt;/control&gt;

    &lt;control&gt;
      &lt;controltype&gt;multi&lt;/controltype&gt;
      &lt;caption&gt;Pattern&lt;/caption&gt;
      &lt;attribute&gt;pattern&lt;/attribute&gt;
      &lt;types&gt;
        simplepattern=Command pattern; string=Regular expression
      &lt;/types&gt;
    &lt;/control&gt;
</code></pre></div></div>

<h3 id="element-lists">Element lists</h3>

<p>These seem to add a new child object to the object, rather than an attribute. Here are some examples:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;control&gt;
      &lt;controltype&gt;elementslist&lt;/controltype&gt;
      &lt;elementtype&gt;object&lt;/elementtype&gt;
      &lt;objecttype&gt;object&lt;/objecttype&gt;
      &lt;expand/&gt;
    &lt;/control&gt;

    &lt;control&gt;
      &lt;caption&gt;Turn scripts - run after every turn the player takes in this room&lt;/caption&gt;
      &lt;controltype&gt;elementslist&lt;/controltype&gt;
      &lt;elementtype&gt;object&lt;/elementtype&gt;
      &lt;objecttype&gt;turnscript&lt;/objecttype&gt;
    &lt;/control&gt;

    &lt;control&gt;
      &lt;caption&gt;Commands&lt;/caption&gt;
      &lt;controltype&gt;elementslist&lt;/controltype&gt;
      &lt;elementtype&gt;object&lt;/elementtype&gt;
      &lt;objecttype&gt;command&lt;/objecttype&gt;
    &lt;/control&gt;
</code></pre></div></div>

<p>Probably not so useful for your custom library - easier to create the object through the GUI normally.</p>

<h3 id="for-completeness">For Completeness</h3>

<p>A couple more examples you will probably never need to see.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      &lt;control&gt;
        &lt;controltype&gt;attributes&lt;/controltype&gt;
        &lt;expand/&gt;
      &lt;/control&gt;

      &lt;control&gt;
        &lt;controltype&gt;gameid&lt;/controltype&gt;
        &lt;caption&gt;Game ID&lt;/caption&gt;
        &lt;attribute&gt;gameid&lt;/attribute&gt;
        &lt;advanced/&gt;
        &lt;desktop/&gt;
      &lt;/control&gt;
</code></pre></div></div>


      <div class="footer">
        <hr/>
        <a href="http://textadventures.co.uk/"><img src="logo.png"/></a>
      </div>
    </div>

  </body>
</html>
