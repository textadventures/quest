<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Followers</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="docs.css">
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Quest Documentation</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li ><a href="index.html">Home</a></li>
            <li ><a href="tutorial/index.html">Tutorial</a></li>
            <li ><a href="http://docs.textadventures.co.uk/quest/scripts/">Scripts</a></li>
            <li ><a href="functions/index.html">Functions</a></li>
            <li ><a href="attributes.html">Attributes</a></li>
            <li><a href="http://textadventures.co.uk/forum">Forum</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>Followers</h1>
      <p>Occasionally it is useful to have one or more characters follow the player, whether a helpful companion, or an annoying foe. Or an annoying companion…</p>

<p>We will store the followers in an object list. This means you can have any number of them trailing along at one time. The first step, then, is to set this up.</p>

<p>Usually at this point I would say that users of the on-line editor are at a disadvantage because they cannot set attributes directly, but for once this is true for users of the off-line editor too - the <em>Attributes</em> tab cannot handle object lists, so we will all be doing this the same way.</p>

<p>For the sake of this tutorial, create an object called “dog”.</p>

<h2 id="setting-up">Setting Up</h2>

<p>On the <code class="highlighter-rouge">game</code> object, go to the <em>Scripts</em> tab, and add these line to the Start script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>player.followers = NewObjectList()
list add (player.followers, dog)
</code></pre></div></div>

<p>Below the start script is the “Script when entering a room”. In there, paste in this code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>foreach (o, player.followers) {
  if (HasAttribute(o, "followphrases")) {
    msg (StringListItem(o.followphrases, GetRandomInt(0, ListCount(o.followphrases) - 1)))
  }
  else {
    msg (CapFirst(GetDisplayName(o)) + " is following you.")
  }
  o.parent = player.parent
}
</code></pre></div></div>

<p>What this does is iterate through each thing in the <code class="highlighter-rouge">followers</code> list. For each one, it checks if there is a <code class="highlighter-rouge">followphrases</code> attributes. If there is, one is selected at random and printed. Otherwise a default phrase is used.</p>

<p>Go in game and see if the dog will follow you!</p>

<h2 id="some-variation">Some Variation</h2>

<p>You game will feel much better if the player is not seeing the same phrase again and again. If she reads “A dog is following you.” every time she goes into a new room, it will get tedious.</p>

<p>So mix it up a bit with the “followphrases” attribute. This is where the off-line users can look smug, they can go to the <em>Attributes</em> tab of the follower, the dog in this case, create a new attribute called “followphrases”, set it to be a string list, and start typing in phrases. On-line users will have to do this in the start script of the <code class="highlighter-rouge">game</code> object. Here is some example code for the dog.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  dog.followphrases = NewStringList()
  list add (dog.followphrases, "A dog enters the room behind you.")
  list add (dog.followphrases, "Sniffing cautiously, a dog follows you into the room.")
  list add (dog.followphrases, "A dog, wagging its tail, enters the room behind you.")
</code></pre></div></div>

<h2 id="adding-and-removing-followers">Adding and Removing Followers</h2>

<p>This is just a matter of adding or removing the follower from the <code class="highlighter-rouge">player.followers</code> list. We added the dog at the start; here it is again, together with removing the dog. Once removed, the dog will stay in the last room it followed the player into.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>list add (player.followers, dog)

list remove (player.followers, dog)
</code></pre></div></div>

<p>You could add these scripts to commands to allow the player to control the dog. For example, for SAY STAY command, you could add this script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  if (not dog.parent = player.parent) {
    msg("Who are you talking to?")
  }
  else if (not ListContains(player.followers, dog)) {
    msg("The dog gives you a strange look.")
  }
  else {
    list remove (player.followers, dog)
    msg("You dog looks at you sadly, as it sits.")
  }
</code></pre></div></div>



      <div class="footer">
        <hr/>
        <a href="http://textadventures.co.uk/"><img src="logo.png"/></a>
      </div>
    </div>

  </body>
</html>
